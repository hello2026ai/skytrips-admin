{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/buddh/skytrips-admin/src/app/page.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useState, useEffect } from \"react\";\r\nimport { useRouter } from \"next/navigation\";\r\n\r\nexport default function LoginPage() {\r\n  const router = useRouter();\r\n  const [email, setEmail] = useState(\"admin@skytrips.com.au\");\r\n  const [password, setPassword] = useState(\"Skytrips@123!\");\r\n  const [showPassword, setShowPassword] = useState(false);\r\n  const [error, setError] = useState(\"\");\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [isCheckingAuth, setIsCheckingAuth] = useState(true);\r\n\r\n  useEffect(() => {\r\n    const checkExistingAuth = async () => {\r\n      try {\r\n        const token = typeof window !== \"undefined\" ? localStorage.getItem(\"sky_admin_session\") : null;\r\n        if (token) {\r\n          router.replace(\"/dashboard\");\r\n        }\r\n      } catch {}\r\n      finally {\r\n        setIsCheckingAuth(false);\r\n      }\r\n    };\r\n    checkExistingAuth();\r\n  }, [router]);\r\n\r\n  const handleLogin = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    setError(\"\");\r\n    setIsLoading(true);\r\n    try {\r\n      if (!email) {\r\n        setError(\"Email is required\");\r\n        setIsLoading(false);\r\n        return;\r\n      }\r\n      const isEmailValid = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(email);\r\n      if (!isEmailValid) {\r\n        setError(\"Invalid email address format\");\r\n        setIsLoading(false);\r\n        return;\r\n      }\r\n      if (!password) {\r\n        setError(\"Password is required\");\r\n        setIsLoading(false);\r\n        return;\r\n      }\r\n      if (password.length < 8) {\r\n        setError(\"Password must be at least 8 characters\");\r\n        setIsLoading(false);\r\n        return;\r\n      }\r\n      const res = await fetch(\"/api/auth/login\", {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify({ email: email.trim(), password }),\r\n      });\r\n      if (!res.ok) {\r\n        const data = await res.json().catch(() => ({}));\r\n        if (data?.code === \"server_config_missing\") {\r\n          setError(\"Server configuration missing. Please configure SUPABASE_SERVICE_ROLE_KEY and ADMIN_SESSION_SECRET.\");\r\n        } else if (data?.error) {\r\n          setError(data.error);\r\n        } else if (res.status === 404) {\r\n          setError(\"No account found for this email\");\r\n        } else if (res.status === 403) {\r\n          setError(\"Account disabled. Contact your administrator.\");\r\n        } else if (res.status === 401) {\r\n          setError(\"Incorrect password\");\r\n        } else if (res.status === 400) {\r\n          setError(\"Invalid request. Please check your inputs.\");\r\n        } else {\r\n          setError(\"Unable to sign in due to a server error\");\r\n        }\r\n        setIsLoading(false);\r\n        return;\r\n      }\r\n      const data = await res.json().catch(() => ({}));\r\n      if (data?.ok && data?.token && data?.user) {\r\n        try {\r\n          localStorage.setItem(\"sky_admin_session\", data.token);\r\n          localStorage.setItem(\"sky_admin_user\", JSON.stringify(data.user));\r\n        } catch {}\r\n      }\r\n      router.replace(\"/dashboard\");\r\n      if (typeof window !== \"undefined\") {\r\n        window.location.href = \"/dashboard\";\r\n        setTimeout(() => {\r\n          try {\r\n            window.location.assign(\"/dashboard\");\r\n          } catch {}\r\n        }, 50);\r\n      }\r\n    } catch (err: unknown) {\r\n      console.error(\"Login error:\", err);\r\n      const errorMessage = err instanceof Error ? err.message : \"An error occurred during login\";\r\n      setError(errorMessage);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  if (isCheckingAuth) {\r\n    return (\r\n      <div className=\"flex min-h-screen items-center justify-center bg-white\">\r\n        <div className=\"text-slate-500\">Loading...</div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"flex min-h-screen items-center justify-center bg-white px-4\">\r\n      <div className=\"w-full max-w-md\">\r\n        <div className=\"bg-white rounded-2xl border border-slate-100 shadow-xl p-8\">\r\n          <div className=\"text-center mb-8\">\r\n            <h1 className=\"text-3xl font-bold text-gray-900 mb-2\">\r\n              Sky Trips Admin\r\n            </h1>\r\n            <p className=\"text-gray-600\">Sign in to your account</p>\r\n          </div>\r\n\r\n          <form onSubmit={handleLogin} className=\"space-y-6\">\r\n            <div>\r\n              <label htmlFor=\"email\" className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                Email Address\r\n              </label>\r\n              <input\r\n                id=\"email\"\r\n                type=\"email\"\r\n                value={email}\r\n                onChange={(e) => setEmail(e.target.value)}\r\n                className=\"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition text-gray-900\"\r\n                placeholder=\"admin@skytrips.com.au\"\r\n                disabled={isLoading}\r\n              />\r\n            </div>\r\n\r\n            <div>\r\n              <label htmlFor=\"password\" className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                Password\r\n              </label>\r\n              <div className=\"relative\">\r\n                <input\r\n                  id=\"password\"\r\n                  type={showPassword ? \"text\" : \"password\"}\r\n                  value={password}\r\n                  onChange={(e) => setPassword(e.target.value)}\r\n                  className=\"w-full px-4 py-3 pr-12 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition text-gray-900\"\r\n                  placeholder=\"Enter your password\"\r\n                  disabled={isLoading}\r\n                />\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={() => setShowPassword(!showPassword)}\r\n                  className=\"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-700 transition-colors\"\r\n                  disabled={isLoading}\r\n                >\r\n                  {showPassword ? \"Hide\" : \"Show\"}\r\n                </button>\r\n              </div>\r\n            </div>\r\n\r\n            {error && (\r\n              <div className=\"bg-red-50 border border-red-200 text-red-600 px-4 py-3 rounded-lg text-sm\">\r\n                {error}\r\n              </div>\r\n            )}\r\n\r\n            <button\r\n              type=\"submit\"\r\n              disabled={isLoading}\r\n              className=\"w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-4 rounded-lg transition duration-200 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n            >\r\n              {isLoading ? \"Signing in...\" : \"Sign In\"}\r\n            </button>\r\n          </form>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 312, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/buddh/skytrips-admin/node_modules/next/navigation.js"],"sourcesContent":["module.exports = require('./dist/client/components/navigation')\n"],"names":[],"mappings":"AAAA,OAAO,OAAO","ignoreList":[0]}}]
}